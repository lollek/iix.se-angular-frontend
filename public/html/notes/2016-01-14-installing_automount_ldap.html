<h2 id="description">Description:</h2>
<p>Setup autofs on machines client-1 and client-2, which both uses ldap (how to install is described in a previous note)</p>
<h2 id="implementation">Implementation:</h2>
<ul>
<li>Install package autofs5-ldap</li>
<li>Create autofs.ldif with the following data:</li>
</ul>
<pre><code>dn: cn=autofs,cn=schema,cn=config
objectClass: olcSchemaConfig
cn: autofs
olcAttributeTypes: {0}( 1.3.6.1.1.1.1.25 NAME &#39;automountInformation&#39; DESC &#39;Inf
 ormation used by the autofs automounter&#39; EQUALITY caseExactIA5Match SYNTAX 1.
 3.6.1.4.1.1466.115.121.1.26 SINGLE-VALUE )
olcObjectClasses: {0}( 1.3.6.1.1.1.1.13 NAME &#39;automount&#39; DESC &#39;An entry in an
 automounter map&#39; SUP top STRUCTURAL MUST ( cn $ automountInformation $ object
 class ) MAY description )
olcObjectClasses: {1}( 1.3.6.1.4.1.2312.4.2.2 NAME &#39;automountMap&#39; DESC &#39;An gro
 up of related automount objects&#39; SUP top STRUCTURAL MUST ou )</code></pre>
<ul>
<li>Add the ldif to ldap:</li>
</ul>
<pre><code>ldapadd -Y EXTERNAL -D cn=admin,(..) -W -f autofs.ldif</code></pre>
<ul>
<li>Create ldif with automount information and a test-user:</li>
</ul>
<pre><code>dn: ou=auto.master,ou=automount,dc=d4,dc=sysinst,dc=ida,dc=liu,dc=se
ou: auto.master
objectClass: top
objectClass: automountMap

dn: cn=/home,ou=auto.master,ou=automount,dc=d4,dc=sysinst,dc=ida,dc=liu,dc=se
cn: /home
objectClass: top
objectClass: automount
automountInformation: ldap:ou=auto.home,ou=automount,dc=d4,dc=sysinst,dc=ida,dc=liu,dc=se --timeout=60 --ghost

dn: ou=auto.home,ou=automount,dc=d4,dc=sysinst,dc=ida,dc=liu,dc=se
ou: auto.home
objectClass: top
objectClass: automountMap

dn: cn=ollehome1,ou=auto.home,ou=automount,dc=d4,dc=sysinst,dc=ida,dc=liu,dc=se
cn: ollehome1
objectClass: top
objectClass: automount
automountInformation: -fstype=nfs,nfsvers=3,rw,soft,intr,exec server.d4.sysinst.ida.liu.se:/export/home1/&amp;</code></pre>
<ul>
<li>Add ldif to ldap:</li>
</ul>
<pre><code>ldapadd -D cn=admin,(..) -W -f autodata.ldif</code></pre>
<ul>
<li>Edit/enable the following lines in /etc/default/autofs:</li>
</ul>
<pre><code>LOGGING=&quot;verbose&quot;
LDAP_URI=&quot;ldap://server.d4.sysinst.ida.liu.se&quot;
SEARCH_BASE=&quot;ou=automount,dc=d4,dc=sysinst,dc=ida,dc=liu,dc=se&quot;
MAP_OBJECT_CLASS=&quot;automountMap&quot;
ENTRY_OBJECT_CLASS=&quot;automount&quot;
MAP_ATTRIBUTE=&quot;ou&quot;
ENTRY_ATTRIBUTE=&quot;cn&quot;
VALUE_ATTRIBUTE=&quot;automountInformation&quot;</code></pre>
<ul>
<li>Add automount to /etc/nsswitch.conf:</li>
</ul>
<pre><code>automount:      files ldap</code></pre>
<ul>
<li>Restart autofs:</li>
</ul>
<pre><code>service autofs restart</code></pre>
<h2 id="verification">Verification:</h2>
<p>Should be able to login on both hosts with ollehome1</p>
