<h2 id="description">Description:</h2>
<p>Configure LDAP to the domain d4.sysinst.ida.liu.se</p>
<h2 id="implementation">Implementation:</h2>
<ul>
<li>Login to server as root</li>
<li>Install the packages slapd, ldap-utils and migrationtools</li>
<li>Set /etc/ldap/ldap.conf so contain the following:</li>
</ul>
<pre><code>#
# LDAP Defaults
#

# See ldap.conf(5) for details
# This file should be world readable but not world writable.

BASE    dc=d4,dc=sysinst,dc=ida,dc=liu,dc=se
URI     ldapi:///</code></pre>
<ul>
<li>In /etc/migrationtools/migrate_common.ph, locate and set the following:</li>
</ul>
<pre><code>$DEFAULT_MAIL_DOMAIN = &quot;d4.sysinst.ida.liu.se&quot;;
$DEFAULT_BASE = &quot;dc=d4,dc=sysinst,dc=ida,dc=liu,dc=se&quot;;</code></pre>
<ul>
<li>cd /usr/share/migrationtools</li>
<li>./migrate_all_online.sh</li>
<li>Install package libnss-ldapd through aptitude, use all services</li>
<li>Edit /etc/nsswitch.conf, change all &quot;compat&quot; to &quot;files&quot;</li>
<li>In /etc/pam.d/common-session, add line to end:</li>
</ul>
<pre><code>session required        pam_mkhomedir.so skel=/etc/skel umask=0022</code></pre>
<h2 id="verification">Verification:</h2>
<ul>
<li>Create /root/olle.ldif</li>
</ul>
<pre><code>root@server:~# cat user.ldif
dn: uid=olle,ou=People,dc=d4,dc=sysinst,dc=ida,dc=liu,dc=se
objectClass: top
objectClass: account
objectClass: posixAccount
objectClass: shadowAccount
cn: olle
uid: olle
uidNumber: 10000
gidNumber: 100
homeDirectory: /home/olle
loginShell: /bin/bash
gecos: olle
userPassword: {crypt}x
shadowLastChange: 0
shadowMax: 99999
shadowWarning: 0</code></pre>
<ul>
<li><code>ldapadd -W -D &quot;cn=admin,dc=d4,dc=sysinst,dc=ida,dc=liu,dc=se&quot; -f olle.ldif</code></li>
<li><p><code>ldappasswd -s mypassword -W -D   &quot;cn=admin,dc=d4,dc=sysinst,dc=ida,dc=liu,dc=se&quot;   &quot;uid=olle,ou=People,dc=d4,dc=sysinst,dc=ida,dc=liu,dc=se&quot;</code></p></li>
<li><p>Running <code>getent passwd</code> should now return olle as a user with uid 10000</p></li>
</ul>
